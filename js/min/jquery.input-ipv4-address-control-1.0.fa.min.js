/*
 * jQuery Input Ip Address Control : v1.0 (2014/09/21)
 * www.sepna.ir
 * https://github.com/sepnair/jquery-ipv4-text-input
 * info@sepna.ir
 * Licensed under the Apache license V2.0.
 * Author: Mahdi.Saberi.gmail.com
 */
(function(e){function t(){e(".IPV4:not([ipv4])").each(function(){var t=["","","",""];if(e(this).val()!=""){a_ipv=e(this).val().split(".");if(a_ipv.length>0)e.each(a_ipv,function(e,n){t[e]=n})}var n=e("<input/>",{"class":"ip1 ipv4",type:"text",value:t[0]});var r=e("<input/>",{"class":"ip2 ipv4",type:"text",value:t[1]});var i=e("<input/>",{"class":"ip3 ipv4",type:"text",value:t[2]});var s=e("<input/>",{"class":"ip4 ipv4",type:"text",value:t[3]});var o=e("<span />",{"class":"ipv4-container"});o.append(n).append(e("<span />",{text:"."})).append(r).append(e("<span />",{text:"."})).append(i).append(e("<span />",{text:"."})).append(s);e(this).before(o).hide();e(this).attr("ipv4","true")})}ip_could_not_be_zero="اولین بخش ip نمی تواند 0 باشد!";no_section_could_not_be_null="هیچ بخشی نمی تواند خالی باشد!";wrong_ip="آدرس IP اشتباه وارد شده است";limit_between_0_255="محدوده عدد بین 0 تا 255";e.fn.getCursorPosition=function(){var e=this.get(0);if(!e)return;if("selectionStart"in e){return e.selectionStart}else if(document.selection){e.focus();var t=document.selection.createRange();var n=document.selection.createRange().text.length;t.moveStart("character",-e.value.length);return t.text.length-n}};e.fn.setCursorPosition=function(t){if(this.length==0)return this;return e(this).setSelection(t,t)};e.fn.setSelection=function(e,t){if(this.length==0)return this;input=this[0];if(input.createTextRange){var n=input.createTextRange();n.collapse(true);n.moveEnd("character",t);n.moveStart("character",e);n.select()}else if(input.setSelectionRange){input.focus();input.setSelectionRange(e,t)}return this};e.fn.focusEnd=function(){this.setCursorPosition(this.val().length);return this};paste=false;e.fn.IPV4=t;e(document).delegate(".ipv4","focus",function(t){if(e(this).hasClass("ip2")||e(this).hasClass("ip3")||e(this).hasClass("ip4")){if(e(this).parent().find(".ip1").val()=="0"||e(this).parent().find(".ip1").val()=="00"||e(this).parent().find(".ip1").val()=="000"){e(this).parent().find(".ip1").focus();alert(ip_could_not_be_zero)}}});e(document).delegate(".ipv4","keydown",function(t){if(t.keyCode==37){if(e(this).getCursorPosition()==0)if(!e(this).hasClass("ip1")){if(e(this).hasClass("ip4"))e(this).parent().find(".ip3").focus();if(e(this).hasClass("ip3"))e(this).parent().find(".ip2").focus();if(e(this).hasClass("ip2"))e(this).parent().find(".ip1").focus();return}}else if(t.keyCode==39){if(e(this).val().length==e(this).getCursorPosition())if(!e(this).hasClass("ip4")){if(e(this).hasClass("ip1"))e(this).parent().find(".ip2").focus();if(e(this).hasClass("ip2"))e(this).parent().find(".ip3").focus();if(e(this).hasClass("ip3"))e(this).parent().find(".ip4").focus()}}if(parseInt(e(this).val())>255||parseInt(e(this).val())<0){e(this).val("255");alert(limit_between_0_255)}});e(document).delegate(".ipv4","keyup",function(t){if(t.keyCode==8&&e(this).val()==""){if(!e(this).hasClass("ip1")){if(e(this).hasClass("ip4"))e(this).parent().find(".ip3").focus();if(e(this).hasClass("ip3"))e(this).parent().find(".ip2").focus();if(e(this).hasClass("ip2"))e(this).parent().find(".ip1").focus()}}if(paste)return;e(this).val(e(this).val().replace(".",""));e(this).val(parseInt(e(this).val()).toString());if(!e.isNumeric(e(this).val())){e(this).val(e(this).val().replace(/\D+$/,""));return}if(parseInt(e(this).val())>255||parseInt(e(this).val())<0){e(this).val("255")}if(t.keyCode!=37&&t.keyCode!=39&&t.keyCode!=8&&(t.keyCode==0||t.keyCode==32||t.keyCode==110||t.keyCode==190||e(this).val().length==3)){e(this).val(e(this).val().trim());if(!e(this).hasClass("ip4")){if(e(this).hasClass("ip1"))e(this).parent().find(".ip2").focus();if(e(this).hasClass("ip2"))e(this).parent().find(".ip3").focus();if(e(this).hasClass("ip3"))e(this).parent().find(".ip4").focus()}}e(this).parent().next().val(e(this).parent().find(".ip1").val()+"."+e(this).parent().find(".ip2").val()+"."+e(this).parent().find(".ip3").val()+"."+e(this).parent().find(".ip4").val())});e(document).delegate(".ipv4","paste",function(t){paste=true;t.stopPropagation();var n=e(this);setTimeout(function(){var t=e(n).val();if(t.split(".").length==4){t=t.split(".");e(n).parent().find(".ip1").val(t[0]);e(n).parent().find(".ip2").val(t[1]);e(n).parent().find(".ip3").val(t[2]);e(n).parent().find(".ip4").val(t[3])}else if(t.split(".").length>=1){e(n).val("");alert(wrong_ip)}paste=false;e(n).parent().next().val(e(n).parent().find(".ip1").val()+"."+e(n).parent().find(".ip2").val()+"."+e(n).parent().find(".ip3").val()+"."+e(n).parent().find(".ip4").val())},100)});e(document).ready(function(){t()})})(jQuery)
